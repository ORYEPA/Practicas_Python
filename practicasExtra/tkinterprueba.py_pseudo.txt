IMPORT tkinter as tk
from tkinter IMPORT filedialog
IMPORT numpy as np #importe de libreria
from matplotlib IMPORT pyplot as plt 
from PIL IMPORT Image
IMPORT cv2
from skimage IMPORT measure
DEFINE FUNCTION procesado_principal(file):
    img=Image.open(file).convert('L')
    SET fig1, ax1 TO plt.subplots()
    SET im TO ax1.imshow(img)
    SET y TO np.array(range(0))
    ax1.plot(y)
    pix_val=list(img.getdata())
    OUTPUT("Maximo= ", np.max(pix_val))
    OUTPUT("Minimo= ", np.min(pix_val))
    img=np.array(img)
    [n,m]=img.shape
    OUTPUT(n)
    OUTPUT(m)
    bw_img=np.zeros(img.shape)
    umbral,img_bin=cv2.threshold(img,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
    SET blobs_labels TO measure.label(img_bin, background=0)
    SET OUTPUT("Islas numero TO ",np.max(blobs_labels))
    SET kernel TO np.ones((3,3), np.uint8)
    OUTPUT(kernel)
    SET img_eroded TO cv2.erode(img_bin, kernel, iterations=2)
    SET umbral,img_bw TO cv2.threshold(img,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
    SET OUTPUT("Umbral Otsu TO ", umbral)
    SET kernel TO np.ones((5,5),np.uint8)
    OUTPUT(kernel)
    SET img_dilate TO cv2.dilate(img_bw,kernel,iterations=5)
    SET blobs_labels TO measure.label(img_dilate,background=0)
    SET OUTPUT("Cantidad de islas TO ", np.max(blobs_labels))
    SET mask TO np.where(blobs_labels==1, 0,1)
    SET mask TO np.logical_not(mask)
    SET img_mask TO np.copy(img)
    SET img_mask[mask] TO 0
    bw_img=np.zeros(img_mask.shape)



    FOR i IN range(n):

        FOR j IN range(m):

            IF img_mask[i,j]>116:

                bw_img[i,j]=1

            ELSE:

                bw_img[i,j]=0  

   

    SET fig, ax TO plt.subplots()

    SET im TO ax.imshow(bw_img)

    SET x TO np.array(range(0))

    ax.plot(x)

    plt.show()









DEFINE FUNCTION open_file_dialog():

    SET file_path TO filedialog.askopenfilename()

    OUTPUT(file_path)

    file=str(file_path)

    procesado_principal(file)

SET root TO tk.Tk()



SET button TO tk.Button(root, text="Open File", command=open_file_dialog)

button.pack()



root.mainloop()

